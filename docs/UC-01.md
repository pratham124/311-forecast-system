# Use Case UC-01: Automatically Pull 311 Service Request Data

**Goal in Context**: Ensure the system retrieves the latest 311 service request data on a defined schedule so operational analytics remain current without manual intervention.  
**Scope**: Operations Analytics System  
**Level**: User Goal  
**Primary Actor**: Operational Manager  
**Secondary Actors**: 311 Data Source API, Scheduling Service, Data Storage System  
**Trigger**: A scheduled time event occurs based on the configured data refresh schedule.

---

## Success End Condition
* Latest 311 service request data is successfully retrieved, validated, stored, and made available for forecasting models and dashboard updates.

## Failed End Condition
* No new data is stored; the system logs the failure and retains previously available data. A failure notification is recorded for monitoring.

---

## Preconditions
* The system has valid credentials and connectivity to the 311 data source.  
* A data refresh schedule has been configured.  
* Storage and processing services are operational.

---

## Main Success Scenario
1. Scheduling Service triggers the data refresh process at the configured time.  
2. System authenticates with the 311 Data Source API.  
3. System requests the latest 311 service request data.  
4. 311 Data Source API returns the requested data.  
5. System validates data format and completeness.  
6. System stores the validated data in the Data Storage System.  
7. System marks the dataset as current and available for forecasting and dashboards.  
8. System logs successful completion of the scheduled data pull.

---

## Extensions
* **2a**: Authentication fails  
  * 2a1: System logs the authentication error.  
  * 2a2: System marks the run as failed.  

* **4a**: Data source unavailable or timeout  
  * 4a1: System logs connection failure.  
  * 4a2: System marks the run as failed.  

* **5a**: Data validation fails  
  * 5a1: System rejects invalid data.  
  * 5a2: System logs validation errors.  
  * 5a3: System marks the run as failed.  

* **6a**: Storage failure  
  * 6a1: System logs storage error.  
  * 6a2: System marks the run as failed.  

---

## Related Information
* **Priority**: High  
* **Frequency**: Scheduled (e.g., hourly or daily depending on configuration)  
* **Open Issues**: Exact schedule interval and retry policy not yet defined.

# UC-01 Fully Dressed Scenario Narratives  
**Use Case:** Automatically Pull 311 Service Request Data  

---

## Main Success Scenario Narrative

At the scheduled time (for example, 02:00 AM), the system’s scheduling service automatically initiates the data refresh process. No human interaction is required.  

The system establishes a secure connection with the 311 data source using stored authentication credentials. The credentials are accepted, and the connection is authorized.

The system sends a request to the 311 API asking for the most recent service request data since the last successful pull. The data source responds successfully and returns the requested dataset.

The system then performs validation checks. It verifies that the file structure matches expectations, required fields are present, data types are correct, and the dataset is not incomplete or corrupted.

After validation succeeds, the system stores the new dataset in the operational data repository. The previous dataset is archived or versioned according to system policy.

The system marks this dataset as the current active dataset for analytics use. Forecasting processes and dashboard queries now automatically reference this updated data.

Finally, the system records a success entry in system logs indicating the time of execution, volume of records processed, and completion status.

The operational manager does not need to take any action and can trust that dashboards and forecasts reflect the most recent information.

---

## Alternative Scenario 2a — Authentication Failure

At the scheduled time, the scheduling service starts the data pull process.  

The system attempts to authenticate with the 311 API using stored credentials. However, authentication fails — for example, the credentials have expired, been revoked, or are misconfigured.

Because authentication cannot be completed, the system does not attempt to request data. It immediately records an authentication failure event in the system log, including the error details returned by the API.

The system marks this run as failed and does not update the dataset. The previously stored dataset remains active for dashboards and forecasts.

Monitoring systems or administrators can later review the logs and correct the credentials before the next scheduled run.

---

## Alternative Scenario 4a — Data Source Unavailable

The scheduler triggers the process as normal, and authentication succeeds.  

When the system attempts to request the latest data, the 311 data source does not respond — for example, the API endpoint is down, network connectivity fails, or a timeout occurs.

After the timeout threshold is reached, the system stops retrying for that run. It logs the connection failure, including timing information and error codes.

No data is stored. The run is marked as failed. Existing datasets remain active so dashboards and forecasting models continue to operate using the most recent previously available data.

---

## Alternative Scenario 5a — Data Validation Failure

The scheduled job runs successfully and retrieves data from the 311 API.  

However, during validation, the system detects problems. Examples include:
- Missing required columns  
- Invalid date formats  
- Corrupted or incomplete data  
- Unexpected schema changes  

Because the data does not meet validation rules, the system rejects the dataset and does not store it.

The system logs detailed validation errors and marks the run as failed. The previous dataset remains active to prevent dashboards or forecasting from using unreliable data.

---

## Alternative Scenario 6a — Storage Failure

The system retrieves and validates the data successfully.  

When attempting to store the dataset, the storage system fails — for example, due to database outage, disk capacity limits, or permission issues.

The system logs the storage error and marks the run as failed. The dataset is not marked as current because it was not safely stored.

The previous dataset remains active, ensuring system continuity.

---

## Key Behavioral Theme Across All Alternatives

In every failure path:

- No partial or unvalidated data becomes active  
- Previously valid data remains in use  
- Failures are logged for operational monitoring  
- No manual intervention is required at the moment of failure  

This preserves dashboard stability and forecast reliability.
